# 02-数据类型

## 1、python程序是怎么组成的

python程序是由一个一个模块组成，一个模块对应着一个python源文件，一般文件名后缀名都是 `.py`

模块又是由语句组成，运行python程序时，按照模块中编写的语句的顺序依次执行。

语句是python程序的构造单元，可以是创建对象、变量赋值、调用函数、控制语句等。

![image-20241110213228299](https://gitee.com/iscn/md_images/raw/master/python/%E7%A8%8B%E5%BA%8F%E7%BB%84%E6%88%90.png)

对于上一章说的交互模式，每次只能执行一条语句；当然我们可以编写多行，但是当我们要实现复杂的逻辑时，交互模式就不太适合了。这时，我们需要创建python文件（即后缀名为`.py`的文件）。

> 这里建议选用一个IDLE环境。比如Pycharm、VScode等。

在开始编写前，我们先说明一下几个注意点

## 2、编写python文件的注意事项

### 2.1 代码的组织和缩进

很多编程语言通过字符(例如：花括号`{}`)、关键字(例如：`begain/end`)来划分代码块。 python 通过缩进来区分代码块，`“缩进”`成为了 Python 语法强制的规定。

- 缩进时，几个空格都是允许的，但是数目必须统一。我们通常采用`“四个空格”`表示一个缩进。 

- 避免将`“tab 制表符”`或者 tab 与空格混合的缩进风格。目前，常用的编辑器一般设置成：tab 制表符就是 4 个空格。  

> 关于代码风格，大家可参考Python官方推荐的 [PEP-8 代码风格详细说明](https://www.python.org/dev/peps/pep-0008/)

### 2.2 使用注释

注释是一个好习惯，注释是程序运行中被 Python 解释器所忽略的一段文本。程序员可以通过注释记录想写的内容，但通常是关于代码的说明。

- python的注释可以分为单行注释，或多行（文本）注释
- 单行注释用`#`号开头
- 多行（文本）注释用三个引号（单引号或双引号都可以）开头和三个引号结束，

```python
# 单行注释：用 # 号符号后面跟注释内容，快捷键：ctrl+/

'''
多行注释
用三个单引号或者多引号
'''
```

### 2.3 使用\行连接符

在交互模式或python文件中，有的语句很长，我们需要换行编写，但又不是第二条语句，为了可读性更强，通常将一行比较长的程序分为多行。这时，我们可以使用`\`行连接符，把它放在行结束的地方。Python 解释器仍然将它们解释为同一行。  

```python
 >>> a = [10,20,30,40,\ 
50,60,70,\ 
80,90,100]
 >>> a  
 [10, 20, 30, 40, 50, 60, 70, 80, 90, 100] 
>>> a = 'abcdefghijklmnopqrstuvwxyz' 
>>> b = 'abcdefg\    
 hijklmn\ 
opqrst\ 
uvwxyz' 
>>> a 
'abcdefghijklmnopqrstuvwxyz' 
>>> b 
'abcdefghijklmnopqrstuvwxyz'  
```

### 2.4 对象

Python 中，一切皆对象。每个对象由：`标识（identity）、类型（type）、value（值）` 组成。

- 标识用于唯一标识对象，通常对应于对象在计算机内存中的地址。使用内置函数 id(obj) 可返回对象 obj 的标识。 

- 类型用于表示对象存储的“数据”的类型。类型可以限制对象的取值范围以及可执行的 操作。可以使用 type(obj)获得对象的所属类型。 

- 值表示对象所存储的数据的信息。使用 print(obj)可以直接打印出值。    

>  **对象的本质就是：一个内存块，拥有特定的值，支持特定类型的相关操作。**

```python
>>> a = 3 
>>> a 
3 
>>> id(3)       # 标识，内存中的身份证号
1531372336 
>>> type(3)     # 类型
<class "int">
>>> b = "我爱你"   # =号后面的就是值
>>> id(a) 
1531372336 
>>> type(a) 
<class 'int'>
 >>> print(a) 
3 
>>> id(b) 
46806816
 >>> type(b) 
<class 'str'>
```

示意图如下

![image-20241110215306944](https://gitee.com/iscn/md_images/raw/master/python/%E5%AF%B9%E8%B1%A1%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

### 2.5 引用

在 Python 中，变量也称为：对象的引用。因为，变量存储的就是对象的地址。变量通过地址引用了“对象”。变量位于：栈内存（压栈出栈等细节，后续再介绍）。 

对象位于：堆内存。  

-  **Python 是动态类型语言**

 变量不需要显式声明类型。根据变量引用的对象，Python会自动赋予对应的类型 

-  **Python 是强类型语言**  

每个对象都有数据类型，只支持该类型支持的操作。

![image-20241110215432437](https://gitee.com/iscn/md_images/raw/master/python/%E5%BC%95%E7%94%A8.png)

### 2.6 标识符

Python中所有的命名都叫做标识符，即在编写代码时自定义的名字，包括变量名、函数名、类名、对象名、模块名、包名。。。。

**标识符的命名应遵循下面的要求：**

- 可以由数字，字母，下划线组成，但不能以数字开头，不能是关键字。
  - 关键字：python中已经取好的名字就叫做关键字
  - 每个关键字都会有独特的含义
  - 在pycharm当中显示：橙色高亮
  - Python中，目前3.10.6解释器中一共有35给关键字如下：

```python
import keyword
# 查看关键字列表
print(keyword.kwlist)
print(len(keyword.kwlist))  # 可以输出35个关键字
['False', 'None', 'True', 'and', 'as', 'assert', 'async', 'await', 'break', 'class', 'continue', 'def', 'del', 'elif', 'else', 'except', 'finally', 'for', 'from', 'global', 'if', 'import', 'in', 'is', 'lambda', 'nonlocal', 'not', 'or', 'pass', 'raise', 'return', 'try', 'while', 'with', 'yield']
```

- 不建议使用不符合规范的名字，
- 应区分大小写

- 应见名知意，尽量使用英文单词进行标识符名字，比如姓名：name，年龄：age
- 遵从小驼峰命名法则
  - 如果一个标识符由多个单词组成，那么可以使用小驼峰命名法
  - 第一个单词首字母小写，第二个单词首字母大写，以此类推，比如：myName
- 遵从大驼峰命名法则
  - 每个单词首字母都大写，比如：FirstName
  - 一般使用场景就是：类名
- 使用下划线命名法
  - 每个单词之间用下划线隔开
  - 比如：user_name ,user_password

> 注意：所有标识符命名唯一可以使用的符号就是_下划线，其他符号都不能使用

开发中，我们通常约定俗称遵守如下规则：  

| **类型**   | **规则**                                                     | **例子**                 |
| ---------- | ------------------------------------------------------------ | ------------------------ |
| 模块和包名 | 全小写字母，尽量简单。若多个单词之间用下划线命名             | math, os, sys            |
| 函数名     | 全小写字母，多个单词之间用下划线隔开                         | phone, my_name           |
| 类名       | 首字母大写，采用驼峰原则。多个单词时， 每个单词第一个字母大写，其余部分小写 | MyPhone、MyClass、 Phone |
| 常量名     | 全大写字母，多个单词使用下划线隔开                           | SPEED、MAX_SPEED         |

## 3、变量和简单赋值语句

- 什么是变量，变量的作用是什么？

变量就是用来存储数据的，准确的说应该对象的引用，存储的数据是存储对象的地址。通过地址引用了对象。它的作用就是通过引用存储不同类型的数据。同时变量的值是可以一直变化或者被覆盖的

- 变量的声明

要想使用变量，就需要先对变量进行声明。如果变量未定义（即，未赋值），使用该变量会提示错误：

```python
>>> n  # try to access an undefined variable
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'n' is not defined
```

Python用`=`用于给变量赋值。赋值后，下一个交互提示符的位置不显示任何结果：

> 语法为： 变量名 = 表达式
>
> 最简单的表达式就是字面量。比如：a = 123 。 运行过程中，解释器先运行右边的表达式， 生成一个代表表达式运算结果的对象；然后，将这个对象地址赋值给左边的变量。  

```python
>>> width = 20
>>> height = 5 * 9
>>> width * height
900
```

- 删除变量和垃圾回收机制

我们通过`=`声明一个变量，同时也可以通过`del`关键字删除不在使用的变量

操作 55】删除变量示例  

```python
>>> a=123
>>> del a
>>> a
Traceback (most recent call last):
File "<pyshell#20>", line 1, in <module>
x
NameError: name 'a' is not define
```

上面中，我们删除了变量`a`后，再次使用就会报错误了。

当然，如果对象没有变量引用，就会被垃圾回收器回收，清空内存空间。这个是python的垃圾回收机制

- 链式赋值和系列解包赋值

什么叫链式赋值？链式赋值用于同一个对象赋值给多个变量。如下面的123对象赋值给x和y

x=y=123 相当于：x=123; y=123  

什么叫解包？系列数据赋值给对应相同个数的变量（个数必须保持一致） 

```python
>>> a,b=1,2
>>> a,b=b,a
>>> print(a,b)
2 1
```

 上述，通过解包赋值快速实现了两个变量之间的值交换

## 4、python最基本的内置数据类型

每个对象都有类型，python 中最基本的内置数据类型：  

- 整型 整数：2345,10,50 

- 浮点型 ：小数，2.14 或者科学计数法 314e-2 

- 布尔型：表示真假，仅包含：True、False 

- 字符串型 由字符组成的序列。如：“abc”,“小橙子”,”百度” 

### 4.1数字和基本运算符

Python支持整数(如：50,520)和浮点数(如：2.14,10.0, 1.23e2)，我们可以对数字做如下运算。  

| **运算符** | **说法**   | **示例** | **结果** |
| ---------- | ---------- | -------- | -------- |
| +          | 加法       | 3+2      | 5        |
| -          | 减法       | 30-5     | 25       |
| *          | 乘法       | 3*6      | 18       |
| /          | 浮点数除法 | 8/2      | 4.0      |
| //         | 整数除法   | 7//2     | 3        |
| %          | 模（取余） | 7%4      | 3        |
| **         | 幂         | 2**3     | 8        |

```python
>>> 2 + 2
4
>>> 50 - 5*6
20
>>> (50 - 5*6) / 4
5.0
>>> 8 / 5  # division always returns a floating point number
1.6
```

除法运算 (`/`) 总是返回浮点数。 如果要做 [floor division] 得到一个整数结果你可以使用 `//` 运算符；要计算余数你可以使用 `%`:

```python
>>> 17 / 3  # classic division returns a float
5.666666666666667
>>>
>>> 17 // 3  # floor division discards the fractional part
5
>>> 17 % 3  # the % operator returns the remainder of the division
2
>>> 5 * 3 + 2  # floored quotient * divisor + remainder
17
```

Python 用 `**` 运算符计算乘方

```python
>>> 5 ** 2  # 5 squared
25
>>> 2 ** 7  # 2 to the power of 7
128
```

**自动转型：**Python 全面支持浮点数；混合类型运算数的运算会把整数转换为浮点数：

```python
>>> 4 * 3.75 - 1
14.0
```

整数可以有多大

Python2 中，int 是 32 位，可以存储从-2147483648 到 2147483647 的整数（约± 21 亿）。Long 类型是 64 位，可以存储：`-2^63--2^63-1` 之间的数值。  

Python3 中，int 可以存储任意大小的整数，long 被取消。我们甚至可以存储下面的 值：  

```python
>>> googol = 10**100
>>> googol
10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

Googol 也是 Google 最初的名字，这也是 Google 最初的含义  

Python3 中可以做超大数的计算，而不会造成“整数溢出”，这也是 Python 特别适 合科学运算的特点。

**类型转换**

当我们运行后不想要浮点数，想将浮点数转化为整形，除了用`//`整除，也可以运算后使用内置函数`int()`来进行类型转换

```python
>>> a = 14.0    # 定义浮点型
>>> type(a)    # type（）函数查看变量类型
<class 'float'>   # 类型为浮点型
>>> a = int(a) 			# 使用int()函数进行类型转换
14
>>> type(a)
<class 'int'>
```

### 4.2 浮点数

浮点数，称为`float`，用科学计数法表示，比如：3.14，表示成：314E-2 或者 314e-2。 这些数字在内存中也是按照科学计数法存储

**类型转换和四舍五入**  

- 类似于 `int()`，我们也可以使用 `float()`将其他类型转化成浮点数。 

- 整数和浮点数混合运算时，表达式结果自动转型成浮点数。比如：2+8.0 的结果是 10.0 

- `round(value)`函数可以返回四舍五入的值  

 注：但不会改变原有值，而是产生新的值  

 **增强型赋值运算符**  

 运算符+、-、*，/、//、**和%和赋值符=结合可以构成“增强型赋值运算符”。 `a = a + 1` 等价于：` a += 1  `

| **运算符** | **例子** | **等价**   |
| ---------- | -------- | ---------- |
| +=         | a += 2   | a = a + 2  |
| -=         | a -=  2  | a = a-2    |
| *=         | a *= 2   | a = a *  2 |
| /=         | a /= 2   | a = a  / 2 |
| //=        | a //= 2  | a = a // 2 |
| **=        | a **= 2  | a = a**2   |
| %=         | a %=  2  | a = a%2    |

 **注意：“+=”中间不能加空格！**

### 4.3 时间的表示

计算机中时间的表示是从“1970 年 1 月 1 日 00:00:00”开始，以毫秒（1/1000 秒） 进行计算。我们也把 1970 年这个时刻成为“unix 时间点”。 

这样，我们就把时间全部用数字来表示了。  

python 中可以通过 `time.time()` 获得当前时刻，返回的值是以秒为单位，带微秒 （1/1000 毫秒）精度的浮点值。例如：1530167364.8566。  

```python
>>> import time
>>> b = int(time.time())
>>> b
1530168754
>>> totalMinutes = b/60
>>> totalMinutes
25502812.566666666
>>> totalMinutes = b//60
>>> totalMinutes
25502812
>>> totalHours = totalMinutes//60
>>> totalHours
425046
>>> totalDays = totalHours//24
>>> totalDays
17710
>>> totalYears = totalDays//365
>>> totalYears
48
```

### 4.4 布尔值

Python2 中没有布尔值，直接用数字 0 表示 False,用数字 1 表示 True。 

Python3 中，把 True 和 False 定义成了关键字，但他们的本质还是 1 和 0，甚至可以和数字相加。  

```python
>>> a = True
>>> b = 3
>>> a+b
4
```

**比较运算符**  

 所有比较运算符返回 1 表示真，返回 0 表示假。这分别与特殊的变量 True 和 False 等价。 以下假设变量 a 为 15，变量 b 为 30：  

| **运算符** | **描述**                            | **实例**                |
| ---------- | ----------------------------------- | ----------------------- |
| ==         | 等于 - 比较对象的值是否相等         | (a == b)   返回 False。 |
| ！=        | 不等于 - 比较两个对象的值是否不相等 | (a ！= b)   返回 true.  |
| >          | 大于 - 返回 x 是否大于 y            | (a > b)   返回 False。  |
| <          | 小于 - 返回 x 是否小于 y            | (a < b)  返回 true.     |
| >=         | 大于等于 - 返回 x 是否大于等于  y   | (a >= b)  返回 False。  |
| <=         | 小于等于 - 返回 x 是否小于等于  y   | (a <= b)  返回true。    |

 **逻辑运算符**  

| **运算符** | **描述** | **实例**                                                     |
| ---------- | -------- | ------------------------------------------------------------ |
| or 逻辑或  | x or  y  | x 为 true，则不计算 y，直接返回 true，x 为 false，则返回 y   |
| and 逻辑与 | x and y  | x 为 true，则返回 y 的值 x 为 false，则不计算 y，直接返回 fals |
| not 逻辑非 | not  x   | x  为 true，返回 false  x 为 false，则返回 true              |

 **同一运算符**  

 同一运算符用于比较两个对象的存储单元，实际比较的是`对象的地址`。

| **运算符** | **描述**                                  |
| ---------- | ----------------------------------------- |
| is         | is 是判断两个标识符是不是引用同一个对象   |
| is not     | is not 是判断两个标识符是不是引用不同对象 |

>  is 与 == 区别：  
>
> - is 用于判断两个变量引用对象是否为同一个，既比较对象的地址。 
> - == 用于判断引用变量引用对象的值是否相等，默认调用对象的 `__eq__()`方法

### 4.5 整数缓存问题

Python 仅仅对较小的整数对象进行缓存（范围为[-5, 256]）缓存起来，而并非是所有整数对象。需要注意的是，这仅仅是在命令行中执行，而在 Pycharm 或者保存为文件执行，结果是不一样的，这是因为解释器做了一部分优化(范围是[-5,任意正整数])。  

-  总结  

1、`is` 比较两个对象的 id 值是否相等，是否指向同一个内存地址； 

2、`==` 比较的是两个对象的内容是否相等，值是否相等； 

3、小整数对象[-5,256]在全局解释器范围内被放入缓存供重复使用； 

4、`is` 运算符比 `==` 效率高，在变量和 None 进行比较时，应该使用 `is`  

 **【操作】同一运算符测试**  

```python
>>> a = 1000
>>> b = 1000
>>> a == b
True
>>> a is b
False
>>> id(a)
46764560
>>> id(b)
46765216
>>> c = 10
>>> d = 10
>>> c is d   # 整数缓存
True
>>> id(c)
1388831648
>>> id(d)
1388831648
```

 **其他运算符**  

 	我们在前面讲解了“+”、“-”、“*”、“/”、“//”、“%”等运算符，这里我们继续 讲解一些其他运算符，并进行学习和测试。  

| 符号            | 意义                             |
| --------------- | -------------------------------- |
| <,<=,>,>=,!=,== | 比较值是否相当，可以连用         |
| \| ^ &          | 按位或，按位异或、按位与         |
| <<, >>          | 左移和右移                       |
| ~               | 按位翻转                         |
| +,-,*,/,//,%    | 加，减，乘，浮点除、整数除、取余 |
| **              | 幂运算                           |

```python
# 1. 比较运算符可以连用，并且含义和我们日常使用完全一致。
>>> a = 4
>>> 3<a<10 # 关系运算符可以连用
True
# 2. 位操作
>>> a = 0b11001
>>> b = 0b01000
>>> c = a|b
>>> bin(c) #bin()可以将数字转成二进制表示
'0b11001' >>> bin(c&b)
'0b01000' >>> bin(c^b)
'0b10001' >>> a = 3
>>> a<<2 #左移 1 位相当于乘以 2. 左移 2 位，相当于乘以 4
12
>>> a = 8
>>> a>>1 #右移 1 位相当于除以 2. 
#3. 加法操作
# (1) 数字相加 
3+2 ==> 5
# (2) 字符串拼接 
“3”+“2”==> “32”
# (3) 列表、元组等合并 
[10,20,30]+[5,10,100] ==>[10,20,30,5,10,100]
#4. 乘法操作
# (1) 数字相乘 
3*2 ==> 6
# (2) 字符串复制 
“sxt”*3 ==> ”sxtsxtsxt”
# (3) 列表、元组等复制 
[10,20,30]*3 ==> [10,20,30,10,20,30,10,20,30]
```

 **复合赋值运算符**  

 复合赋值可以让程序更加精炼，提高效率。  

| **运算符** | **描述**            | **示例**            | **等价于**                   |
| ---------- | ------------------- | ------------------- | ---------------------------- |
| +=         | 加法赋值 字符串拼接 | sum += n a += “sxt” | sum = sum + n  a = a + “sxt” |
| -=         | 减法赋值            | num1 -=  n          | num = num -  n               |
| *=         | 乘法赋值            | a *= b              | a = a * b                    |
| /=         | 浮点除赋值          | a/=b                | a = a / b                    |
| //=        | 整数除赋值          | a//=b               | a = a//b                     |
| %=         | 取余赋值            | a%=b                | a = a % b                    |
| **=        | 幂运算赋值          | a**=2               | a = a**2                     |
| <<=        | 左移赋值            | a<<=2               | a = a<<  2                   |
| >>=        | 右移赋值            | a>>=2               | a = a>>  2                   |
| &=         | 按位与赋值          | a&=b                | a = a&b                      |
| \|=        | 按位或赋值          | a\|=b               | a=a\|b                       |
| ^=         | 按位异或赋值        | a^=b                | a = a^b                      |

>  **注：与 C 和 JAVA 不一样，Python 不支持自增(++)和自减(--)**  

 **运算符优先级问题**  

 如下优先级，从高到低。  

| **运算符**               | **描述**             |
| ------------------------ | -------------------- |
| **                       | 指数 (最高优先级)    |
| ~                        | 按位翻转             |
| * / % //                 | 乘，除，取模和取整除 |
| + -                      | 加法减法             |
| >> <<                    | 右移，左移运算符     |
| &                        | 位 'AND'             |
| ^ \|                     | 位运算符             |
| <= < > >=                | 比较运算符           |
| <> == !                  | 等于运算符           |
| = %= /= //= -= += *= **= | 赋值运算符           |
| is is not                | 身份运算符           |
| in not in                | 成员运算符           |
| not or and               | 逻辑运算符           |

 实际使用中，记住如下简单的规则即可，复杂的表达式一定要使用小括号组织。  

- 乘除优先加减 

- 位运算和算术运算>比较运算符>赋值运算符>逻辑运算符  

## 5、字符串

在 Python 中处理文本数据是使用`str` 对象，字符串（`str`）是由字符组成的序列，是一种非常常用的数据类型。`字符串在Python中是不可变的（immutable）`，也就是说一旦创建，就无法修改它的内容。

### 5.1 创建字符串

你可以使用单引号 (`'`) 或双引号 (`"`) 来创建字符串。它们是等价的，但如果字符串内部包含引号，可以使用另一种类型的引号来避免转义。

- 单引号: `'允许包含有 "双" 引号'`
- 双引号: `"允许嵌入 '单' 引号"`
- 三重引号: `'''三重单引号'''`, `"""三重双引号"""`
- 字符串中反斜杠 `\` 用于转义

```python
>>> 'spam eggs'  # 单引号
'spam eggs'
>>> 'doesn\'t'  # 使用 \' 转义输出单引号
"doesn't"
>>> "doesn't"  # 双引号中包含单引号 
"doesn't"
>>> '"Yes," they said.'  # 单引号中可以包含双引号
'"Yes," they said.'
>>> "\"Yes,\" they said."  # 使用\转义双引号
'"Yes," they said.'
>>> '"Isn\'t," they said.'
'"Isn\'t," they said.'
```

### 5.2 字符串的编码

Python 3 中字符串是 Unicode 字符串，可以表示世界上任何书面语言的字符。ASCII 码是 Unicode 编码的子集。 

使用内置函数`ord()`可以把字符转换成对应的 Unicode 码； 

使用内置函数`chr()`可以把十进制数字转换成对应的字符。 

```python
>>> ord('A')
65
>>> ord('高')
39640
>>> chr(66)
'B' >>> ord('淇')
28103
```

如果你需要处理字节流，可以将字符串编码为字节（`bytes`），或者将字节解码为字符串。

```python
# 编码为字节
s = "Hello"
b = s.encode('utf-8')
print(b)  # 输出: b'Hello'

# 解码为字符串
s2 = b.decode('utf-8')
print(s2)  # 输出: Hello
```

### 5.3 字符串转义

Python用反斜杠 `\` 表示转义，我们可以使用`\+特殊字符`，实现某些难以用字符表示的效果。比如换行等。常见的 转义字符有这些：  

| **转义字符**  | **描述**        |
| ------------- | --------------- |
| `\(在行尾时)` | 续行符          |
| `\\`          | 反斜杠符号      |
| `\'`          | 单引号          |
| `\"`          | 双引号          |
| `\b`          | 退格(Backspace) |
| `\n`          | 换行            |
| `\t`          | 横向制表符      |
| `\r`          | 回车            |

如果不希望前置 `\` 的字符转义成特殊字符，可以使用 *原始字符串*，在引号前添加 `r` 即可：

```python
>>> print('C:\some\name')  # 这儿 \n 换行
C:\some
ame
>>> print(r'C:\some\name')  # 使用 r 里面展示原始字符串
C:\some\name
```

原始字符串还有一个微妙的限制：一个原始字符串不能以奇数个 `\` 字符结束；

### 5.4 **字符串的常见操作**

#### 5.4.1 字符串的访问

字符串支持 *索引* （下标访问），第一个字符的索引是 0。单字符没有专用的类型，就是长度为一的字符串：

```python
>>> word = 'Python'
>>> word[0]  # 取索引下标为 0 的字符串
'P'
>>> word[5]  # 取索引下标为 5 的字符串
'n'
```

索引还支持负数，用负数索引时，从右边开始计数：

```python
>>> word[-1]  # 取最后一个字符串
'n'
>>> word[-2]  # 取倒数第二个字符串
'o'
>>> word[-6]  # 取倒数第6个字符串
'P'
```

> 注意，-0 和 0 一样，因此，负数索引从 -1 开始。

#### 5.4.2 切片

除了索引，字符串还支持 `切片`。索引可以提取单个字符，`切片` 则提取子字符串：

切片语法为 `str[start:end:step]`，其中: 

- `start` 是起始位置（**包括**），`end` 是结束位置（**不包括**），`step` 是步长。

- `step`为负数的情况 ： `start`和`end`不写，`step`为`-1` 将字符串倒序输出 
-  `step`默认为1，可以不写

 **典型操作(三个量为正数的情况)如下：**  

| **操作和说明**                                       | **示例**        | **结果** |
| ---------------------------------------------------- | --------------- | -------- |
| [:] 提取整个字符串                                   | “abcdef”[:]     | “abcdef” |
| [start:]从 start 索引开始到结尾                      | “abcdef”[2:]    | “cdef”   |
| [:end]从头开始直到 end-1                             | “abcdef”[:2]    | “ab”     |
| [start:end]从 start 到 end-1                         | “abcdef”[2:4]   | “cd”     |
| `[start:end:step]`从 start 提取到 end-1，步长是 step | “abcdef”[1:5:2] | “bd”     |

 **其他操作（三个量为负数）的情况：**  

| **示例**                             | **说明**                              | **结果**                      |
| ------------------------------------ | ------------------------------------- | ----------------------------- |
| "abcdefghijklmnopqrstuv wxyz"[-3:]   | 取倒数三个                            | “xyz”                         |
| "abcdefghijklmnopqrstuv wxyz"[-8:-3] | 取倒数第八个到倒数第 三个(包头不包尾) | 'stuvw'                       |
| "abcdefghijklmnopqrstuv wxyz"[::-1]  | 步长为负，从右到左 反向提取           | 'zyxwvutsrqpon mlkjihgfedcba' |

切片操作时，起始偏移量和终止偏移量不在[0,字符串长度-1]这个范围，也不会报错。起始 偏移量小于 0 则会当做 0，终止偏移量大于“长度-1”会被当成-1。例如：  

```plsql
 >>> "abcdefg"[3:50] 
'defg  
```

我们发现正常输出了结果，没有报错。

```python
>>> word[0:2]  # 提取索引0-2的字符串，不包含2
'Py'
>>> word[2:5]  # characters from position 2 (included) to 5 (excluded)
'tho'
```

切片索引的默认值很有用；省略开始索引时，默认值为 0，省略结束索引时，默认为到字符串的结尾：

```python
>>> word[:2]   # character from the beginning to position 2 (excluded)
'Py'
>>> word[4:]   # characters from position 4 (included) to the end
'on'
>>> word[-2:]  # characters from the second-last (included) to the end
'on'
```

注意，输出结果包含切片开始，但不包含切片结束。因此，`s[:i] + s[i:]` 总是等于 `s`：

```python
>>> word[:2] + word[2:]
'Python'
>>> word[:4] + word[4:]
'Python'
```

还可以这样理解切片，索引指向的是字符 *之间* ，第一个字符的左侧标为 0，最后一个字符的右侧标为 *n* ，*n* 是字符串长度。例如：

```python
 +---+---+---+---+---+---+
 | P | y | t | h | o | n |
 +---+---+---+---+---+---+
 0   1   2   3   4   5   6
-6  -5  -4  -3  -2  -1
```

第一行数字是字符串中索引 0...6 的位置，第二行数字是对应的负数索引位置。*i* 到 *j* 的切片由 *i* 和 *j* 之间所有对应的字符组成。

对于使用非负索引的切片，如果两个索引都不越界，切片长度就是起止索引之差。例如， `word[1:3]` 的长度是 2。

索引越界会报错：

```python
>>> word[42]  # the word only has 6 characters
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: string index out of range
```

但是，切片会自动处理越界索引：

```python
>>> word[4:42]
'on'
>>> word[42:]
''
```

Python 字符串不能修改，是不可变类型[immutable] 的。因此，为字符串中某个索引位置赋值会报错：

```python
>>> word[0] = 'J'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'str' object does not support item assignment
>>> word[2:] = 'py'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'str' object does not support item assignment
```

要生成不同的字符串，应新建一个字符串：

```python
>>> 'J' + word[1:]
'Jython'
>>> word[:2] + 'py'
'Pypy'
```

内置函数 [`len()`](https://docs.python.org/zh-cn/3.10/library/functions.html#len) 返回字符串的长度：

```python
>>> s = 'supercalifragilisticexpialidocious'
>>> len(s)
34
```

#### 5.4.3 字符串连接和重复

字符串可以用 `+` 合并（粘到一起），也可以用 `*` 重复：

```python
>>> # 3 times 'un', followed by 'ium'
>>> 3 * 'un' + 'ium'
'unununium'
```

相邻的两个或多个 *字符串字面值* （引号标注的字符）会自动合并：

```python
>>> 'Py' 'thon'
'Python'
```

拼接分隔开的长字符串时，这个功能特别实用：

```python
>>> text = ('Put several strings within parentheses '
...         'to have them joined together.')
>>> text
'Put several strings within parentheses to have them joined together.'
```

这项功能只能用于两个字面值，不能用于变量或表达式：

```python
>>> prefix = 'Py'
>>> prefix 'thon'  # can't concatenate a variable and a string literal
  File "<stdin>", line 1
    prefix 'thon'
           ^^^^^^
SyntaxError: invalid syntax
>>> ('un' * 3) 'ium'
  File "<stdin>", line 1
    ('un' * 3) 'ium'
               ^^^^^
SyntaxError: invalid syntax
```

合并多个变量，或合并变量与字面值，要用 `+`：

```python
>>> prefix + 'thon'
'Python'
```

### 5.5 字符串的常用方法

#### 5.5.1 replace()实现字符串替换  

我们知道字符串是“不可改变”的，但我们可以通过`[]`获取字符串指定位置的字符。如果我们尝试改变字符串中某个字符，就会出现以下报错：

```python
>>> a = 'abcdefghijklmnopqrstuvwxyz' 
>>> a
'abcdefghijklmnopqrstuvwxyz' 
>>> a[3]='高' Traceback (most recent call last):
File "<pyshell#94>", line 1, in <module>
a[3]='高' 
TypeError: 'str' object does not support item assignment
```

字符串不可改变。但是，我们确实有时候需要替换某些字符。这时，只能通过创建新的字符串来实现。  使用`str.replace(ole_str,new_str,count)`方法来替换

- `ole_str`：被替换的内容 
- `new_str`：替换的内容 
- `count`：替换的次数，一般不写，默认是全部替换 
- `返回`：替换之后的完整的字符串 注意：原来的字符串没有发生改变 

```python
 >>> a = 'abcdefghijklmnopqrstuvwxyz' 
>>> a
'abcdefghijklmnopqrstuvwxyz' 
>>> id(a)
2506751634896
>>> a = a.replace('c','高')
'ab 高 defghijklmnopqrstuvwxyz'
>>> id(a)
2506767420032
```

整个过程中，可以看见变量`a`的地址已经发生了改变，实际上我们是创建了新的字符串对象，并指向了变量 a，而不是修改了以前的字符串。 内存图如下：

![image-20241111080258876](https://gitee.com/iscn/md_images/raw/master/python/%E5%86%85%E5%AD%98.png)

#### 5.5.2 split()分割和 join()合并

有时间我们可能需要对字符串进行分隔（拆分），这时可以用`str.split(sep,maxsplit)`方法来实现

- `sep`：字符串按照什么进行拆分，默认是空白字符（空格，换行\n，tab键\t） 
- `max_split`:分割次数，一般不写，全部分割 
- `返回`：将一个字符串拆分为多个，存在列表中 
- 注意：如果sep不写，想要指定分割n次数，则需要按照指定分隔次数 ：`str.split(max_split=n)` n是次数  

 `split()`可以基于指定分隔符将字符串分隔成多个子字符串(存储到列表中)。如果不指定分隔符，则默认使用空白字符(换行符/空格/制表符)。示例代码如下：  

```python
>>> a = "to be or not to be" 
>>> a.split()
['to', 'be', 'or', 'not', 'to', 'be']
>>> a.split('be')
['to ', ' or not to ', '']
```

` join()`的作用和 `split()`作用刚好相反，用于将一系列子字符串连接起来。示例代码如下：  

```python
>>> a = ['sxt','sxt100','sxt200']
>>> '*'.join(a)
'sxt*sxt100*sxt200'
```

**拼接字符串要点：**  

使用字符串拼接符`+`，会生成新的字符串对象，因此不推荐使用`+`来拼接字符串。推荐使用 `join` 函数，因为 `join` 函数在拼接字符串之前会计算所有字符串的长度，然后逐一拷贝， 仅新建一次对象。  

`str.join(列表)` #括号中的内容主要是列表，可以是其他容器 
**作用：**将字符串插入到列表中每相邻的两个数据之间，组成一个新的字符串，列表中的数据使用逗号隔开的 
**使用场景**：将列表或者其他容器数据连接为字符串 
**注意点**：列表中的数据必须都是字符串，否则会报错  

之前我们用`+`也能实现字符串拼接，我们下面测试`+`拼接符和 `join()`，不同的效率

```python
import time
time01 = time.time() #起始时刻
a = ""
for i in range(1000000):
	a += "sxt"
time02 = time.time() #终止时刻
print("运算时间："+str(time02-time01))
time03 = time.time() #起始时刻
li = []
for i in range(1000000):
	li.append("sxt")
	a = "".join(li)
	time04 = time.time() #终止时刻
print("运算时间："+str(time04-time03))
```

####  5.5.3 字符串驻留机制和字符串比较  

**字符串驻留：**仅保存一份相同且不可变字符串的方法，不同的值被存放在字符串驻留池中。 Python 支持字符串驻留机制，对于符合标识符规则的字符串（仅包含下划线（_）、字母 和数字）会启用字符串驻留机制驻留机制。  

```python
>>> a = "abd_33" 
>>> b = "abd_33" 
>>> a is b
True
>>> c = "dd#" 
>>> d = "dd#" 
>>> c is d
False
>>> str1 = "aa" 
>>> str2 = "bb" 
>>> str1+str2 is "aabb"
False
>>> str1+str2 == "aabb" 
True
```

 **字符串比较和同一性**  

 	我们可以直接使用==,!=对字符串进行比较，是否含有相同的字符。 我们使用 is / not is，判断两个对象是否同一个对象。比较的是对象的地址，即 id(obj1)是 否和 id(obj2)相等。  

 **成员操作符**  

`in /not in 关键字`，判断某个字符(子字符串)是否存在于字符串中。 

####  5.5.4 常用查找方法  

我们以下面一段文本作为测试： 

```
a='''我是小明,今年18岁了,我在北京科技上班。我的儿子叫小华，他6岁了。我是一个编程教育的普及者，希望影响6000万学习编程的中国人。我儿子现在也开始学习编程，希望他18岁的时候可以超过我'''
```

| **方法和使用示例**         | **说明**                     | **结果** |
| -------------------------- | ---------------------------- | -------- |
| `len(a)`                   | 字符串长度                   | 92       |
| `a.startswith('我是小明')` | 以指定字符串开头             | True     |
| `a.endswith('过我')`       | 以指定字符串结尾             | True     |
| `a.find('小')`             | 第一次出现指定字符串的位置   | 2        |
| `a.rfind('小')`            | 最后一次出现指定字符串的位置 | 26       |
| `a.count("编程")`          | 指定字符串出现了几次         | 3        |
| `a.isalnum()`              | 所有字符全是字母或数字       | False    |

####  5.5.5 去除首尾信息  

 我们可以通过`str.strip()`去除字符串首尾指定信息。通过`str.lstrip()`去除字符串左边指定信息， `str.rstrip()`去除字符串右边指定信息。  

 **【操作】去除字符串首尾信息**  

```python
>>> "*s*x*t*".strip("*")
's*x*t' 
>>> "*s*x*t*".lstrip("*")
's*x*t*' 
>>> "*s*x*t*".rstrip("*")
'*s*x*t' 
>>> " sxt ".strip()
'sxt
```

####  5.5.6 大小写转换  

 编程中关于字符串大小写转换的情况，经常遇到。我们将相关方法汇总到这里。为了方便学习，先设定一个测试变量：  

```
a = "xiaoming love programming, love PYTHON"
```

| **示例**       | **说明**                             | **结果**                                 |
| -------------- | ------------------------------------ | ---------------------------------------- |
| a.capitalize() | 产生新的字符串,首字母 大写           | 'Xiaoming love programming, love python' |
| a.title()      | 产生新的字符串,每个单 词都首字母大写 | 'Xiaoming Love Programming, Love Python' |
| `a.upper()`    | 产生新的字符串,所有字 符全转成大写   | 'XIAOMING LOVE PROGRAMMING, LOVE PYTHON' |
| `a.lower()`    | 产生新的字符串,所有字 符全转成小写   | 'xiaoming love programming, love python' |
| a.swapcase()   | 产生新的,所有字母大小 写转换         | 'XIAOMING LOVE PROGRAMMING, LOVE python' |

####  5.5.7 格式排版  

上面说过

```python
center()、ljust()、rjust() # 这三个函数用于对字符串实现排版。示例如下：
>>> a="SXT" 
>>> a.center(10,"*")
'***SXT****' 
>>> a.center(10)
' SXT ' 
>>> a.ljust(10,"*")
'SXT*******'
```

####  5.5.8 其他方法  

- `str.isalnum()` 是否为字母或数字 

- `str.isalpha()` 检测字符串是否只由字母组成(含汉字)。 

- `str.isdigit()` 检测字符串是否只由数字组成。

- `str.isspace()` 检测是否为空白符 

- `str.isupper()` 是否为大写字母 

- `str.islower()` 是否为小写字母  

```python
>>> "sxt100".isalnum()
True
>>> "sxt 科技".isalpha()
True
>>> "234.3".isdigit()
False
>>> "23423".isdigit()
True
>>> "aB".isupper()
False
>>> "A".isupper()
True
>>> "\t\n".isspace()
True
```

### 5.6 字符串的格式化

#### 5.6.1 旧式格式化（使用 `%`）

旧式的字符串格式化使用%占位，其中`d%`表示整数型数据，`s%`表示字符串，`f%`表示浮点数

```python
name = "Alice"
age = 30
s = "Name: %s, Age: %d" % (name, age)
print(s)  # 输出: Name: Alice, Age: 30
```

#### 5.6.2 format()基本用法

Python2.6 开始，新增了一种格式化字符串的函数 `str.format()`，它增强了字符串格式化的功能

基本语法是通过 {} 和来代替以前的 % 占位。  

format 函数可以接受不限个参数，位置可以不按顺序。  

我们通过示例进行格式化的学习。  

```python
>>> a = "名字是:{0},年龄是：{1}" 
>>> a.format("小明",18)
'名字是:小明,年龄是：18' 
>>> a.format("小华",6)
'名字是:小华,年龄是：6' 
>>> b = "名字是：{0}，年龄是{1}。{0}是个好小伙" 
>>> b.format("小明",18)
'名字是：小明，年龄是 18。小明是个好小伙' 
>>> c = "名字是{name}，年龄是{age}" 
>>> c.format(age=19,name='小华')
'名字是小明，年龄是 19'
```

我们可以通过{索引}/{参数名}，直接映射参数值，实现对字符串的格式化，非常方便。

#### 5.6.3 f-strings（Python 3.6+）

python3.6版本及以上又新增了一种字符串的格式化方法，通过在字符串前加 `f`，可以直接在字符串中嵌入变量。

```python
name = "Alice"
age = 30
s = f"Name: {name}, Age: {age}"
print(s)  # 输出: Name: Alice, Age: 30
```

> 虽然有多种方式，但是推荐使用`str.format()`的方式进行字符串的格式化

#### 5.6.4 填充与对齐

填充常跟对齐一起使用

 `^、<、>分别是居中、左对齐、右对齐`，后面带宽度  

`:`号后面带填充的字符，只能是一个字符，不指定的话默认是用空格填充  

```python
>>> "{:*>8}".format("245")
'*****245' 
>>> "我是{0},我喜欢数字{1:*^8}".format("小明","666")
'我是小明,我喜欢数字**666***'
```

  **数字格式化**  

 浮点数通过`f`，整数通过 `d` 进行需要的格式化。案例如下：  

```python
>>> a = "我是{0}，我的存款有{1:.2f}" 
>>> a.format("小明",3888.234342)
'我是小明，我的存款有 3888.23
```

 其他格式，供大家参考：  

| **数字**   | **格式** | **输出**  | **描述**                       |
| ---------- | -------- | --------- | ------------------------------ |
| 2.1415926  | {:.2f}   | 2.14      | 保留小数点后两位               |
| 2.1415926  | {:+.2f}  | 2.14      | 带符号保留小数点后两位         |
| 2.71828    | {:.0f}   | 3         | 不带小数                       |
| 5          | {:0>2d}  | 05        | 数字补零 (填充左边, 宽度为 2)  |
| 5          | {:x<4d}  | 5xxx      | 数字补  x (填充右边, 宽度为 4) |
| 10         | {:x<4d}  | 10xx      | 数字补 x (填充右边, 宽度为 4)  |
| 1000000    | {:,}     | 1,000,000 | 以逗号分隔的数字格式           |
| 0.25       | {:.2%}   | 25.00%    | 百分比格式                     |
| 1000000000 | {:.2e}   | 1.00E+09  | 指数记法                       |
| 13         | {:10d}   | 13        | 右对齐 (默认, 宽度为 10)       |
| 13         | {:<10d}  | 13        | 左对齐 (宽度为 10)             |
| 13         | {:^10d}  | 13        | 中间对齐 (宽度为 10)           |

### 5.7 可变字符串

在Python中，字符串属于不可变对象，不支持原地修改，如果需要修改其中的值，只能创建新的字符串。但是，我们确实经常需要原地修改字符串，这时可以用`io.StringIO`对象或array模块

```python
import io
s = "hello,world!"
s_io = io.StringIO(s)
print(s_io)
print(s_io.seek(7))
print(s_io.write("g"))
print(s_io.getvalue())
```

## 6、输入和输出函数

在Python中，输入和输出操作是非常常见的。我们主要使用以下两个函数来进行输入和输出操作：

### 6.1 **`input()` 函数**

`input()`函数用于从用户那里获取输入。它会暂停程序的执行，等待用户输入内容，并返回输入的字符串。

**语法：**

```python
pythonCopy Codeinput([prompt])
```

- `prompt`：可选参数，表示显示在用户输入前的提示信息（字符串）。如果不提供`prompt`，则不显示提示信息。

**示例：**

```python
pythonCopy Code# 获取用户的姓名并打印
name = input("请输入您的姓名：")
print("你好，" + name)
```

**输出示例：**

```python
Copy Code请输入您的姓名：Alice
你好，Alice
```

### 6.2 **`print()` 函数**

`print()`函数用于将输出打印到控制台。它可以输出各种类型的对象，包括字符串、数字、列表等。

**语法：**

```python
pythonCopy Codeprint(*objects, sep=' ', end='\n', file=sys.stdout, flush=False)
```

- `*objects`：要输出的一个或多个对象。可以是字符串、数字、列表等。
- `sep`：指定多个对象之间的分隔符，默认是一个空格。
- `end`：指定输出结束时的字符，默认是换行符`\n`。可以修改`end`参数的值实现不换行打印
- `file`：指定输出的目标，默认输出到控制台。
- `flush`：是否立即刷新输出缓冲区，通常保持为`False`。

**示例：**

```python
pythonCopy Code# 输出文本
print("Hello, World!")

# 输出多个变量，默认用空格分隔
name = "Alice"
age = 30
print(name, age)

# 使用自定义分隔符和结尾
print("Hello", "World", sep="-", end="!\n")
```

**输出示例：**

```python
Copy CodeHello, World!
Alice 30
Hello-World!
```

### 6.3 综合示例：输入和输出结合

```python
pythonCopy Code# 获取用户输入
name = input("请输入您的姓名：")
age = input("请输入您的年龄：")

# 输出用户输入的内容
print("您输入的姓名是：", name)
print("您输入的年龄是：", age)
```

### 注意事项：

`input()`函数返回的是字符串类型，因此如果需要处理数字输入（如整数或浮点数），需要使用`int()`或`float()`

进行转换：

```python
Codeage = int(input("请输入您的年龄："))
```